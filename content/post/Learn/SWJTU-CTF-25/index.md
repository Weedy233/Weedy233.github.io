---
title: SWJTU-CTF-25 æ–°ç§€æ¯ WP
date: 2025-12-15
image: logo.jpg
categories:
  - CTF
  - ç«èµ›
  - ç½‘å®‰
---

## Misc

### å“ˆåŸºç±³å¾—äº†mvp

é™„ä»¶æ˜¯ä¸€ä¸ªåŠ å¯†å‹ç¼©åŒ… `encrypted.zip` å’Œæ˜æ–‡ `plaintext.txt`ï¼Œç«‹é©¬æƒ³åˆ°å·²çŸ¥æ˜æ–‡æ”»å‡»

1. ä½¿ç”¨ bkcrack ç®€å•æ£€æŸ¥ä¸€ä¸‹ï¼ŒåŠ å¯†ç®—æ³•æ˜¯ ZipCryptoï¼Œç›´æ¥ç¡®å®š
2. ä½¿ç”¨ 7zip åˆ¶ä½œæ˜æ–‡å‹ç¼©åŒ…ï¼Œæ³¨æ„ä½¿ç”¨â€œä»…å­˜å‚¨â€
3. ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ç ´è§£å¯†é’¥

```shell
bkcrack -C hakimi_mvp_challenge.zip -c plaintext.txt -P plain.zip -p plaintext.txt
```

4. å¾—åˆ°å¯†é’¥åç›´æ¥è§£å¯†å‹ç¼©åŒ…æ‹¿åˆ° flag

```shell
bkcrack -C hakimi_mvp_challenge.zip -k a0b1c2d3 e4f5g6h7 i8j9k0l1 -d cracked.zip
```

### å—·å‘œ

ä»Šå¹´çš„ misc ç™½ç»™é¢˜ï¼Œæœ‰ç»éªŒ ~~ï¼ˆæ‰¾è¿‡èµ„æºï¼‰~~ çš„äººåº”è¯¥èƒ½ç›´æ¥è®¤å‡ºæ¥ï¼Œç›´æ¥æ”¾åˆ°å…½éŸ³è§£ç å·¥å…·ä¸­è§£ç å³å¯

### æˆ‘ä»¬çš„æ¸¸æˆç¢ºæœ‰å•é¡Œ

ä¸»åŠæ–¹åœ¨èµ›ç¨‹ä¸­é—´çªç„¶æ”¾å‡ºçš„ misc æ¸¸æˆé¢˜ï¼ˆä»Šå¹´è²Œä¼¼å› ä¸ºæ—¶é—´æœ‰é™å®Œæˆåº¦ä¸é«˜ï¼‰ï¼Œé¦–æ€è¿˜æœ‰ç‰¹æ®Šå¥–åŠ±

è¿™é¢˜å‘å¸ƒçš„æ—¶å€™æˆ‘è¿˜åœ¨ä¸‰é£Ÿå ‚å•ƒé¸¡è…¿å‘¢ï¼Œçœ‹å¤§ä¼™åœ¨ç¾¤é‡Œé¢å“€åšï¼Œæˆ‘åªèƒ½ç”¨æ‰‹æœºé¢å¯¹ç€ exe å‘å‘†ï¼Œæƒ³ç€é¦–æ€ä¼°è®¡æ˜¯æ²¡æˆäº†

å›å¯å®¤æ‰“å¼€ç”µè„‘ä¸€çœ‹ï¼Œæ¸¸æˆå›¾æ ‡æ€ä¹ˆæ˜¯ä¸ª pythonï¼Ÿé¡¿æ—¶â€œæ¶ç›¸èƒ†è¾¹ç”ŸğŸ˜ˆâ€ï¼šä½ è¯´ï¼Œå‡ºé¢˜äººå‡ºé¢˜çš„æ—¶å€™ä¼šä¸ä¼šå¿˜è®°åšåŠ å¯†/æ··æ·†å‘¢ï¼Ÿ
ç„¶åè¿™é¢˜å°±ä» misc é¢˜å˜æˆäº† reverse é¢˜ï¼ˆ

1. é¦–å…ˆä»å›¾æ ‡å‡ ä¹å¯ä»¥è‚¯å®šç”¨çš„æ˜¯ **PyInstaller** æ‰“åŒ…çš„ï¼Œä½†æ˜¯ä»¥é˜²å‡ºé¢˜äººæœ‰è¯ˆ(x)ï¼Œæˆ‘ä»¬ç”¨ `strings` å‘½ä»¤å†ç¡®è®¤ä¸€ä¸‹

```console
â¯ strings æ©˜é›ªè‰çš„å¥‡å¹»å†’é™©.exe | grep "pyi"
_pyi_main_co
pyi-python-flag
pyi-runtime-tmpdir
pyi-contents-directory
pyi-hide-console
pyi-
_pyinstaller_pyz
mpyimod01_archive
mpyimod02_importers
mpyimod03_ctypes
mpyimod04_pywin32
spyiboot01_bootstrap
spyi_rth_inspect
opyi-contents-directory _internal
```

è¿™ä¸‹ç¡®å®šæ˜¯ **PyInstaller** æ‰“åŒ…äº†

2. ç›´æ¥ä½¿ç”¨ [pyinstxtractor.py](https://github.com/extremecoders-re/pyinstxtractor) è¿›è¡Œè§£åŒ…ï¼Œè·å–æ–‡ä»¶å¤¹ `æ©˜é›ªè‰çš„å¥‡å¹»å†’é™©.exe_extracted`

3. æ‰¾åˆ°é‡Œé¢çš„æœ€å¤§çš„ pyc æ–‡ä»¶ `game.pyc`ï¼Œï¼ˆè¿™ä¸€æ­¥æœ¬æ¥åº”è¯¥è¿˜éœ€è¦ä½¿ç”¨ `struct.pyc` è¿›è¡Œè¡¥å¤´ï¼Œä½†æ˜¯æ–°ç‰ˆæœ¬çš„ **pyinstxtractor** å·²ç»å¸®æˆ‘ä»¬æŠŠè¿™ä¸€æ­¥åšå®Œäº†ï¼‰ã€‚ç›´æ¥ä½¿ç”¨ [pycdc](https://github.com/zrax/pycdc) æˆ–æ˜¯åœ¨çº¿å·¥å…·è¿›è¡Œåç¼–è¯‘

4. æ¸¸æˆé€»è¾‘
ä»åç¼–è¯‘ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œ**æ­£å¸¸**é€šå…³æ–¹æ³•æ˜¯æœé›†å­—æ¯æ‹¼å‡ºå•è¯ *kindred*ï¼Œflag å°±ä¼šå‡ºç°
ä½†æ˜¯è¿™ä¸ªæ¸¸æˆè¿˜éšè—äº†å‡ ä¸ªåé—¨ï¼š
> 1. ç”¨æˆ·åä½¿ç”¨ *kindred* æ—¶ï¼Œç›´æ¥æ˜¾ç¤º flag å‰åŠéƒ¨åˆ†ï¼Œå¹¶ä¸”è§£é”ä¼ é€å’Œå…¨å›¾æŸ¥çœ‹åŠŸèƒ½ï¼Œè¿˜å¯ä»¥ç©¿å¢™å’ŒåŠ é€Ÿ
> 2. ç”¨æˆ·åä½¿ç”¨ *admin*/*debug* æ—¶ï¼Œå¯ä»¥æŸ¥çœ‹åæ ‡/å†…å­˜å˜é‡çŠ¶æ€
> 3. åœ¨æ¸¸æˆä¸­ä½¿ç”¨ `ä¸Šä¸Šä¸‹ä¸‹å·¦å³å·¦å³BABA` è¿™ä¸ªé­‚æ–—ç½—ç»å…¸ç§˜ç±çš„æ—¶å€™ï¼Œç›´æ¥è·å¾— flag ååŠéƒ¨åˆ†

5. æœ€åæ‹¼å‡ºå®Œæ•´ç­”æ¡ˆ `flag{kindred_thank_you_for_playing_this_game}`

![æ‰‹åˆ¹å·²æ‹¿](image/index/1765790492363.jpg) ![å’Œå‡ºé¢˜äººçš„å¯¹è¯](image/index/1765790498534.jpg)

æœ€åæ‹¿åˆ°äº†å¥–å“é­”å®¡ï¼Œå¥½è€¶ğŸ¥°

### æ˜Ÿç¯æ—¥å¿—ï¼šç¬¬7å·æ®‹ç‰‡

pdf é¢˜ï¼Œä¾æ—§æ–‡ä»¶éšå†™ï¼Œé¢˜ç›®æç¤ºæ˜¯ `XOR+?+?`

1. é¦–å…ˆç”¨çº¯æ–‡æœ¬æ ¼å¼æ‰“å¼€æŸ¥çœ‹ï¼Œå‘ç° Object 9 æ˜¯ä¸€ä¸ªåµŒå…¥å¼æ–‡ä»¶æµï¼ˆStreamï¼‰ï¼Œé•¿åº¦ä»… 60 å­—èŠ‚ï¼Œä¸”æ²¡æœ‰æ ‡æ³¨ Filterï¼ˆè¿‡æ»¤å™¨ï¼‰ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯è£¸å­—èŠ‚ï¼ˆRaw Bytesï¼‰
2. æå–å‡ºå­—èŠ‚æµå†…å®¹ï¼š`/:*q6 .*!s{&1 ;#$(rs{&4!$s.!/&. /w$` ç¡®å®æœ‰å¾ˆå¤šä¸å¯è§å­—ç¬¦ï¼Œæ ¹æ®å¯†æ–‡çš„å‰å‡ ä¸ªå­—èŠ‚ä»¥åŠå›ºå®šæ ¼å¼ "flag{...}"ï¼Œè¿™é‡Œå¯ä»¥çŒœå‡ºå¯†é’¥åº”è¯¥æ˜¯ 42ï¼ˆå®‡å®™çš„ç»ˆæç­”æ¡ˆï¼‰
3. æ¥ä¸‹æ¥ä½¿ç”¨ 42 è¿›è¡Œå¼‚æˆ–ï¼Œå¾— base64 ç»“æœ`ZmxhZ3tFbGlhc19TdGVsbGFyaXNfMjE0N19FdXJvcGFfRW1lcmdlbmN5fQ==`ï¼Œè§£ç å¾—`flag{Elias_Stellaris_2147_Europa_Emergency}`

<!-- Todo: å†™å®ŒRGB-->
<!-- ### æœ€åçš„ R.G!B?

è¿™é¢˜å…¶å®æ²¡åšå‡ºæ¥ï¼Œè¿˜å·®æœ€åä¸€ä¸ª part 3ï¼Œç»ˆå½’æ˜¯é“è¡Œä¸å¤ŸğŸ˜‡ï¼Œè¿™é‡Œè¿˜æ˜¯è®°å½•ä¸€ä¸‹åšé¢˜æµç¨‹ -->

### æœˆåŠçŒ«å’Œå¥¶é¾™çœŸæ˜¯ä¸€å¯¹è‹¦å‘½é¸³é¸¯

ä¸€å¼€å§‹ç”¨ stegsolve å äº†åŠå¤©ï¼Œçœ‹èƒ–çŒ«å¥¶é¾™çš„ç¼åˆæ€ªæŠŠæˆ‘ san å€¼éƒ½è¦å¹²æ²¡äº†ï¼Œæœ€åå‘ç°æ”¾è¿›éšæ³¢é€æµä¸€æŠŠæ¢­äº†ï¼ˆï¼Œä¸¤ä¸ªå›¾ç‰‡RG0å’Œ00Bæ‹¼èµ·æ¥å°±æ˜¯ flag

![ç‰¢è®°æœ€é«˜æŒ‡ç¤ºğŸ«¡](image/index/1765792309859.jpg)

### é˜¿è¨æ‹‰ç”µå°

éŸ³é¢‘éšå†™é¢˜ï¼Œç”±é¢˜ç›®çš„æç¤º "you could see the audio"ï¼Œé¦–å…ˆä½¿ç”¨é¢‘è°±åˆ†æï¼Œä½†æ˜¯åˆ†ææ— æœã€‚åé¢æ€€ç–‘ä½¿ç”¨ LSB åœ¨æ¯ä¸ªé‡‡æ ·ç‚¹çš„æœ€ä½ä½è¿›è¡Œéšå†™ï¼Œç»æµ‹è¯•æ­£å¥½å‘ç°äº† PNG æ–‡ä»¶å¤´`89 50 4E 47 0D 0A 1A 0A`ã€‚ç¼–å†™ä¸‹æ–¹è„šæœ¬å¯ä»¥æå–å‡ºä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«æå³å¯å¾—å‡º flag

```python
import numpy as np
from scipy.io import wavfile

def solve():
    fs, data = wavfile.read('asara_radio_station.wav')

    lsb = data & 1
    lsb_bytes = np.packbits(lsb)

    png_signature = b'\x89\x50\x4E\x47\x0D\x0A\x1A\x0A'
    lsb_data = lsb_bytes.tobytes()
    start_offset = lsb_data.find(png_signature)

    if start_offset != -1:
        print(f"åœ¨åç§»é‡ {start_offset} å¤„å‘ç° PNG â½‚ä»¶å¤´ï¼")
        png_data = lsb_data[start_offset:]
        with open('flag.png', 'wb') as f:
            f.write(png_data)
        print("æˆåŠŸæå–â½‚ä»¶: flag.png")
        print("è¯·æ‰“å¼€ flag.png æŸ¥çœ‹æœ€ç»ˆ Flagã€‚")
    else:
        print("æœªåœ¨ LSB æ•°æ®ä¸­å‘ç° PNG â½‚ä»¶å¤´ã€‚")

if __name__ == '__main__':
    solve()
```

æ€¨å¿µï¼šæ¯æ¬¡æœ‰äºŒç»´ç çš„é¢˜éƒ½è¦å¡åŠå¤©ï¼Œå»å¹´æ›¼å½»æ–¯ç‰¹çš„ä¹Ÿæ˜¯ï¼ˆåè¡€

## Crypto

### Broadcast Mayday!

å½“åŒä¸€ä¸ªæ˜æ–‡æ¶ˆæ¯ $m$ ä½¿ç”¨ç›¸åŒçš„**å°å…¬é’¥æŒ‡æ•°** $e$ï¼ˆè¿™é‡Œ $e=3$ï¼‰åŠ å¯†å‘é€ç»™ $k$ ä¸ªä¸åŒçš„æ¥æ”¶è€…ï¼ˆæ¨¡æ•°ä¸º $n_1, n_2, \dots, n_k$ï¼‰ï¼Œä¸” $k \ge e$ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨**ä¸­å›½å‰©ä½™å®šç† (CRT)** æ¢å¤å‡ºæ˜æ–‡ã€‚

å·²çŸ¥ï¼š
$$
\begin{cases}
c_1 \equiv m^e \pmod{n_1} \\
c_2 \equiv m^e \pmod{n_2} \\
c_3 \equiv m^e \pmod{n_3}
\end{cases}
$$

æˆ‘ä»¬å¯ä»¥é€šè¿‡ CRT è®¡ç®—å‡ºä¸€ä¸ªæ•° $C$ï¼Œä½¿å¾—ï¼š
$$ C \equiv m^e \pmod{n_1 \cdot n_2 \cdot n_3} $$

è§£é¢˜è„šæœ¬ï¼š

```python
import sympy
import gmpy2

# --- é¢˜ç›®ç»™å‡ºçš„æ•°æ® ---
e = 3

n1 = 92115348414647145744942290482438108731351762209411954562581348940707868731036245627500433519371993679505350448706770557161219940579492266005829570662132118431769877704072034110899075752607538375198156669112004335086224921217459978021792019801412747035487994163136912896890937398834748390623372881042019936713
c1 = 37200871830656989509585109324571909904756015127793123197130883254106018377171885657835514800162401320146006985022958231927796179533942338054373296193632356913787597295032396539550096310631833715431578658537578254861531650216064367780472605097680343437199708398358791853856381695077

n2 = 107724705233055883081751721820024537967383348784274707683197256750962086833992211892130729806540411724416536258297016669042940442848435141693540234286837159113373010687953933673937825312480194072635181507552396292463829107673816320217815715976290351449432206814810274039955958399317467366451913130432389085003
c2 = 37200871830656989509585109324571909904756015127793123197130883254106018377171885657835514800162401320146006985022958231927796179533942338054373296193632356913787597295032396539550096310631833715431578658537578254861531650216064367780472605097680343437199708398358791853856381695077

n3 = 94872673633406396995297289835600763806262337074512934673113566808569442630985008762887860592268702511296878448137078036296381031226430144507819817141157483185804334623630822323025118948888645875600836830885573655432196307004742051095606839449546166172293018214114182272767946968456915879022656708269505066749
c3 = 37200871830656989509585109324571909904756015127793123197130883254106018377171885657835514800162401320146006985022958231927796179533942338054373296193632356913787597295032396539550096310631833715431578658537578254861531650216064367780472605097680343437199708398358791853856381695077

# --- æ”»å‡»è¿‡ç¨‹ ---

print("å¼€å§‹æ‰§è¡Œå“ˆæ–¯å¡”å¾·å¹¿æ’­æ”»å‡»...")

# 1. ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç† (CRT) æ±‚è§£ M = m^e
# sympy.ntheory.modular.crt çš„å‚æ•°æ˜¯ (æ¨¡æ•°åˆ—è¡¨, ä½™æ•°åˆ—è¡¨)
moduli = [n1, n2, n3]
remainders = [c1, c2, c3]

# crt è¿”å›ä¸€ä¸ªå…ƒç»„ (è§£, æ¨¡æ•°çš„ä¹˜ç§¯)
M, N = sympy.ntheory.modular.crt(moduli, remainders)
print(f"1. ä½¿ç”¨ CRT æ±‚å¾— M = m^{e} = {M}")
print(f"   æ¨¡æ•°çš„ä¹˜ç§¯ N = n1*n2*n3 = {N}")
print("-" * 20)

# 2. å¯¹ M å¼€ e æ¬¡æ–¹æ ¹ï¼Œå¾—åˆ° m
# ä½¿ç”¨ gmpy2.iroot è¿›è¡Œç²¾ç¡®çš„æ•´æ•°å¼€æ–¹ï¼Œå®ƒè¿”å› (æ ¹, æ˜¯å¦ä¸ºå®Œç¾å¹‚)
m, is_perfect_root = gmpy2.iroot(M, e)

if is_perfect_root:
    print(f"2. æˆåŠŸå¯¹ M å¼€ {e} æ¬¡æ–¹æ ¹ï¼Œå¾—åˆ° m = {m}")
    print("-" * 20)

    # 3. å°†æ•´æ•° m è½¬æ¢ä¸ºå­—ç¬¦ä¸² (flag)
    # è®¡ç®—å°†æ•´æ•° m è½¬æ¢ä¸ºå­—èŠ‚æ‰€éœ€çš„é•¿åº¦
    byte_length = (m.bit_length() + 7) // 8
    flag_bytes = m.to_bytes(byte_length, "big")

    try:
        flag = flag_bytes.decode("utf-8")
        print(f"3. å°† m è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¾—åˆ° Flag:")
        print(flag)
    except UnicodeDecodeError:
        print("3. æ— æ³•è§£ç ä¸º UTF-8ï¼ŒåŸå§‹å­—èŠ‚ä¸º:")
        print(flag_bytes)

else:
    print(f"2. M ä¸æ˜¯ä¸€ä¸ªå®Œç¾çš„ {e} æ¬¡æ–¹ï¼Œæ”»å‡»å¤±è´¥ã€‚")
    print("   è¿™å¯èƒ½æ„å‘³ç€æ¨¡æ•°ä¸äº’è´¨ï¼Œæˆ–è€…è¿™ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„å¹¿æ’­æ”»å‡»ã€‚")

```

### Secure Token?

è¿™é¢˜çš„ç›®æ ‡å·²ç»è¯´æ˜ï¼šä¼ªé€ ä¸€ä¸ªå…·æœ‰ç®¡ç†å‘˜æƒé™çš„ tokenï¼Œä»è€Œè®¿é—® /admin é¡µé¢

é‚£ä¹ˆæˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹ MD5ã€SHA1ã€SHA256 è¿™äº›ç®—æ³•çš„æ ¸å¿ƒé€»è¾‘ï¼š
1. åˆå§‹åŒ–ï¼š ç®—æ³•æœ‰ä¸€ä¸ªå›ºå®šçš„åˆå§‹çŠ¶æ€ï¼ˆIVï¼‰ã€‚

2. ç¬¬ä¸€æ£’ï¼ˆå¤„ç† Block 1ï¼‰ï¼š æ‹¿ç€ IV å’Œç¬¬ä¸€å—æ•°æ®è¿›è¡Œå¤æ‚çš„è¿ç®—ï¼Œå¾—å‡ºä¸€ä¸ªä¸­é—´çŠ¶æ€ï¼ˆStateï¼‰ã€‚

3. ç¬¬äºŒæ£’ï¼ˆå¤„ç† Block 2ï¼‰ï¼š æ‹¿ç€â€œç¬¬ä¸€æ£’çš„ä¸­é—´çŠ¶æ€â€ä½œä¸ºèµ·ç‚¹ï¼Œå’Œç¬¬äºŒå—æ•°æ®è¿ç®—ï¼Œå¾—å‡ºæ–°çš„çŠ¶æ€ã€‚

4. ...ä»¥æ­¤ç±»æ¨...

5. ç»ˆç‚¹ï¼š å¤„ç†å®Œæ‰€æœ‰æ•°æ®åï¼Œæœ€åçš„ä¸­é—´çŠ¶æ€å°±æ˜¯æˆ‘ä»¬çœ‹åˆ°çš„å“ˆå¸Œå€¼ï¼ˆSignatureï¼‰ã€‚

è¿™é‡Œçš„æ¼æ´å°±åœ¨äºï¼šå¦‚æœæˆ‘ä»¬çŸ¥é“äº†ä¸­é—´çŠ¶æ€ï¼Œå³ä½¿ä¸çŸ¥é“å‰é¢çš„æ•°æ®æ˜¯ä»€ä¹ˆï¼Œä¾ç„¶èƒ½æ¥åŠ›ç»§ç»­è®¡ç®—å‡ºæ–°çš„å“ˆå¸Œå€¼

æœ¬é¢˜ä½¿ç”¨äº†è¿™ä¸ªéªŒè¯æ–¹å¼ $Token=SHA1(SECRET_KEY+username)$ï¼Œå³ä½¿ä¸çŸ¥é“å‰é¢çš„æ•°æ®ï¼ˆSECRET_KEYï¼‰æ˜¯ä»€ä¹ˆï¼Œä¹Ÿå¯ä»¥æ¥è¿‡è¿™ä¸€æ£’ï¼Œç»§ç»­å¾€åæ·»åŠ æ•°æ®ï¼Œç®—å‡ºæ–°çš„å“ˆå¸Œå€¼

å“ˆå¸Œç®—æ³•åœ¨å¤„ç†æ•°æ®å‰ï¼Œä¸€å®šä¼šå¯¹æ•°æ®è¿›è¡Œå¡«å……ï¼Œä½¿å…¶é•¿åº¦æ»¡è¶³æ•´å—çš„è¦æ±‚ï¼ˆ64å­—èŠ‚å€æ•°ï¼‰ã€‚ åŸæœ¬æœåŠ¡å™¨åšçš„äº‹æƒ…æ˜¯ï¼š SHA1( `[Key]` `[guest]` `[Padding]` ) --> å¾—åˆ° Token(æ—§)

è¿™é‡Œçš„ `[Padding]` æ˜¯æ ¹æ® len(Key) + len("guest") è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œé€šå¸¸åŒ…å« \x80ã€ä¸€å † \x00 å’Œ æ•°æ®æ€»é•¿åº¦ã€‚
æˆ‘ä»¬è¦åœ¨è¿™ä¸ªåŸºç¡€ä¸Šâ€œç»­å†™â€æ•°æ®ã€‚æ—¢ç„¶æˆ‘ä»¬è¦åˆ©ç”¨æ—§çš„ Token ç»§ç»­ç®—ï¼Œé‚£ä¹ˆæ–°çš„æ•°æ®ç»“æ„å¿…é¡»ä¸¥æ ¼éµå®ˆä¹‹å‰çš„ç‰©ç†é¡ºåºï¼šä¼ªé€ çš„æ•°æ®æµ = `[Key]` `[guest]` `[Padding]` `[admin]`

ç„¶åä½¿ç”¨ä½¿ç”¨ `hashpump`ï¼Œç»§ç»­å¤„ç†å­—ç¬¦ä¸² "admin"

ä»¥ä¸‹æ˜¯çˆ†ç ´ key é•¿åº¦åŠ ä¼ªé€ æ•°æ®çš„è„šæœ¬ï¼š

```python
from pwn import *
import hashpumpy
import re

# é…ç½®è¿æ¥ä¿¡æ¯
HOST = '47.108.129.134'
PORT = 33769 # è¯·ç¡®ä¿ç«¯å£ä¸ä½ å½“å‰çš„é¢˜ç›®å®ä¾‹ä¸€è‡´

# å¼€å¯ pwntools çš„æ—¥å¿—ï¼Œæ–¹ä¾¿çœ‹è¿‡ç¨‹ï¼ˆå¦‚æœè§‰å¾—å¤ªåµå¯ä»¥æ”¹æˆ 'error'ï¼‰
context.log_level = 'info' 

def attack():
    # åŸå§‹æ•°æ®å’Œè¦é™„åŠ çš„æ•°æ®
    original_data = 'guest'
    append_data = 'admin'

    # æˆ‘ä»¬ä¸çŸ¥é“å¯†é’¥é•¿åº¦ï¼Œéœ€è¦çˆ†ç ´ (å‡è®¾é•¿åº¦åœ¨ 1-64 ä¹‹é—´)
    # è™½ç„¶ Token å˜äº†ï¼Œä½†é€šå¸¸å¯†é’¥çš„é•¿åº¦æ˜¯å›ºå®šçš„é…ç½®
    for key_length in range(1, 64):
        try:
            p = remote(HOST, PORT)
            
            # 1. è¯»å–æœåŠ¡å™¨çš„æ¬¢è¿ä¿¡æ¯
            # è¯»å–ç›´åˆ°æç¤ºè¾“å…¥çš„åœ°æ–¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ‹¿åˆ°äº†ä¸Šé¢æ‰€æœ‰çš„æ–‡æœ¬
            welcome_msg = p.recvuntil(b"Enter 'username:token' to login (raw bytes allowed): ")
            
            # 2. ä½¿ç”¨æ­£åˆ™æå–å½“å‰çš„ Guest token
            # å¯»æ‰¾ "Guest token: " åé¢çš„ 40 ä½ hex å­—ç¬¦
            # output decode ä¸º string æ–¹ä¾¿æ­£åˆ™åŒ¹é…
            match = re.search(r'Guest token: ([a-f0-9]{40})', welcome_msg.decode(errors='ignore'))
            
            if not match:
                log.failure("Could not extract token from server response.")
                p.close()
                continue
                
            current_token = match.group(1)
            log.info(f"[*] Key Len Guess: {key_length} | Captured Token: {current_token}")

            # 3. ä½¿ç”¨ HashPump è®¡ç®—æ–°çš„ç­¾åå’Œ payload
            # å‚æ•°: (current_hash, original_data, data_to_add, key_length)
            new_hash, new_message = hashpumpy.hashpump(current_token, original_data, append_data, key_length)

            # 4. å‘é€ Payload
            # æ ¼å¼: username:token
            # new_message å·²ç»æ˜¯åŒ…å« padding çš„ bytes äº†ï¼Œæ— éœ€ encode
            payload = new_message + b':' + new_hash.encode()
            
            p.sendline(payload)

            # 5. è·å–ç»“æœ
            response = p.recvall(timeout=2).decode(errors='ignore')
            
            p.close()

            # 6. æ£€æŸ¥ Flag
            if 'flag{' in response or 'success' in response.lower():
                print("\n" + "="*50)
                print(f"[+] SUCCESS! Found Flag with key length: {key_length}")
                print("Response content:")
                print(response)
                print("="*50 + "\n")
                return # æ‹¿åˆ° flag ç›´æ¥é€€å‡ºå‡½æ•°

            # å¦‚æœæ²¡æœ‰ flagï¼Œè¯´æ˜è¿™ä¸ª key_length ä¸å¯¹ï¼ˆæˆ–è€…æœåŠ¡å™¨çœŸçš„åœ¨æ ¡éªŒ key å†…å®¹æ˜¯å¦æ­£ç¡®ï¼‰
            # ç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯

        except Exception as e:
            log.warning(f"Connection error or exception: {e}")
            try:
                p.close()
            except:
                pass

if __name__ == "__main__":
    attack()
```

